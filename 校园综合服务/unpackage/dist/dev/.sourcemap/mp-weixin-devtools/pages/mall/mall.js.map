{"version":3,"names":["common_vendor","require","common_assets","utils_config","_sfc_main","__name","setup","__props","products","ref","filteredProducts","searchResults","categories","selectedCategory","searchKeyword","hasSearched","menuVisible","postAnimation","manageAnimation","ordersAnimation","onShow","getProducts","index","request","url","concat","config","baseURL","method","success","res","__f__","data","availableProducts","filter","item","status","value","onSearchInput","e","detail","trim","onSearch","searchResults2","title","toLowerCase","includes","length","showToast","icon","onCategorySelect","category","getFilteredProducts","baseData","filtered","toDetail","id","find","item2","trade_id","navigateTo","setTimeout","$emit","toggleMenu","opacity","transform","navigateToPost","navigateToManage","navigateToOrders","_ctx","_cache","a","o","$event","b","c","d","f","i0","t","n","g","k0","fileList","type","price","sellerAvatar","sellerName","h","_imports_0$1","i","j","_imports_1$1","k","s","l","m","_imports_2","p","_imports_3","q","r","wx","createPage"],"sources":["pages/mall/mall.js"],"sourcesContent":["\"use strict\";\nconst common_vendor = require(\"../../common/vendor.js\");\nconst common_assets = require(\"../../common/assets.js\");\nconst utils_config = require(\"../../utils/config.js\");\nconst _sfc_main = {\n  __name: \"mall\",\n  setup(__props) {\n    const products = common_vendor.ref([]);\n    const filteredProducts = common_vendor.ref([]);\n    const searchResults = common_vendor.ref([]);\n    const categories = common_vendor.ref([\n      \"全部\",\n      \"电子产品\",\n      \"学习用品\",\n      \"生活用品\",\n      \"运动用品\",\n      \"其他\"\n    ]);\n    const selectedCategory = common_vendor.ref(\"全部\");\n    const searchKeyword = common_vendor.ref(\"\");\n    const hasSearched = common_vendor.ref(false);\n    const menuVisible = common_vendor.ref(false);\n    const postAnimation = common_vendor.ref({});\n    const manageAnimation = common_vendor.ref({});\n    const ordersAnimation = common_vendor.ref({});\n    common_vendor.onShow(() => {\n      getProducts();\n    });\n    const getProducts = () => {\n      common_vendor.index.request({\n        url: `${utils_config.config.baseURL}/trades`,\n        method: \"GET\",\n        success: (res) => {\n          common_vendor.index.__f__(\"log\", \"at pages/mall/mall.vue:106\", \"📦 获取商品列表:\", res.data);\n          const availableProducts = res.data.filter((item) => item.status === \"可交易\");\n          products.value = availableProducts;\n          filteredProducts.value = availableProducts;\n          searchResults.value = availableProducts;\n        }\n      });\n    };\n    const onSearchInput = (e) => {\n      searchKeyword.value = e.detail.value.trim();\n    };\n    const onSearch = () => {\n      if (!searchKeyword.value) {\n        filteredProducts.value = products.value;\n        searchResults2.value = products.value;\n        hasSearched.value = false;\n        return;\n      }\n      const searchResults2 = products.value.filter((item) => item.title.toLowerCase().includes(searchKeyword.value.toLowerCase())).filter((item) => item.status === \"可交易\");\n      filteredProducts.value = searchResults2;\n      searchResults2.value = searchResults2;\n      hasSearched.value = true;\n      selectedCategory.value = \"全部\";\n      if (searchResults2.length === 0) {\n        common_vendor.index.showToast({\n          title: \"没有找到相关商品\",\n          icon: \"none\"\n        });\n      }\n    };\n    const onCategorySelect = (category) => {\n      selectedCategory.value = category;\n      getFilteredProducts();\n    };\n    const getFilteredProducts = () => {\n      const baseData = hasSearched.value ? searchResults.value : products.value;\n      let filtered = baseData.filter((item) => item.status === \"可交易\");\n      if (selectedCategory.value !== \"全部\") {\n        filtered = filtered.filter((item) => item.category === selectedCategory.value);\n      }\n      filteredProducts.value = filtered;\n    };\n    const toDetail = (id) => {\n      const item = filteredProducts.value.find((item2) => item2.trade_id === id);\n      common_vendor.index.__f__(\"log\", \"at pages/mall/mall.vue:168\", item);\n      common_vendor.index.navigateTo({\n        url: \"/pages/mall/detail/detail\",\n        // success: function(res) {\n        // \tuni.$emit(\"sendProductData\", {\n        // \t\titem\n        // \t})\n        // }\n        success: (res) => {\n          setTimeout(() => {\n            common_vendor.index.$emit(\"sendProductData\", {\n              item\n            });\n          }, 100);\n        }\n      });\n    };\n    const toggleMenu = () => {\n      if (!menuVisible.value) {\n        menuVisible.value = true;\n        setTimeout(() => {\n          postAnimation.value = {\n            opacity: 1,\n            transform: \"translate(-80rpx, -80rpx)\"\n          };\n          manageAnimation.value = {\n            opacity: 1,\n            transform: \"translate(-120rpx, -10rpx)\"\n          };\n          ordersAnimation.value = {\n            opacity: 1,\n            transform: \"translate(-10rpx, -120rpx)\"\n          };\n        }, 50);\n      } else {\n        postAnimation.value = {\n          opacity: 0,\n          transform: \"translate(0, 0)\"\n        };\n        manageAnimation.value = {\n          opacity: 0,\n          transform: \"translate(0, 0)\"\n        };\n        ordersAnimation.value = {\n          opacity: 0,\n          transform: \"translate(0, 0)\"\n        };\n        setTimeout(() => {\n          menuVisible.value = false;\n        }, 300);\n      }\n    };\n    const navigateToPost = () => {\n      common_vendor.index.navigateTo({\n        url: \"/pages/mall/post/post\"\n      });\n    };\n    const navigateToManage = () => {\n      common_vendor.index.navigateTo({\n        url: \"/pages/mall/manage/manage\"\n      });\n    };\n    const navigateToOrders = () => {\n      common_vendor.index.navigateTo({\n        url: \"/pages/mall/orders/orders\"\n      });\n    };\n    return (_ctx, _cache) => {\n      return common_vendor.e({\n        a: common_vendor.o([($event) => searchKeyword.value = $event.detail.value, onSearchInput]),\n        b: common_vendor.o(onSearch),\n        c: searchKeyword.value,\n        d: common_vendor.o(onSearch),\n        e: common_vendor.f(categories.value, (category, index, i0) => {\n          return {\n            a: common_vendor.t(category),\n            b: index,\n            c: common_vendor.o(($event) => onCategorySelect(category), index),\n            d: common_vendor.n(selectedCategory.value === category ? \"selected\" : \"\")\n          };\n        }),\n        f: filteredProducts.value.length > 0\n      }, filteredProducts.value.length > 0 ? {\n        g: common_vendor.f(filteredProducts.value, (item, k0, i0) => {\n          return {\n            a: item.fileList[0].type === \"video\" ? \"/static/image/video-placeholder.png\" : item.fileList[0].url,\n            b: common_vendor.t(item.title),\n            c: common_vendor.t(item.price),\n            d: item.sellerAvatar,\n            e: common_vendor.t(item.sellerName),\n            f: item.trade_id,\n            g: common_vendor.o(($event) => toDetail(item.trade_id), item.trade_id)\n          };\n        })\n      } : {}, {\n        h: common_assets._imports_0$1,\n        i: common_vendor.o(toggleMenu),\n        j: common_assets._imports_1$1,\n        k: common_vendor.s(postAnimation.value),\n        l: common_vendor.o(navigateToPost),\n        m: common_assets._imports_2,\n        n: common_vendor.s(manageAnimation.value),\n        o: common_vendor.o(navigateToManage),\n        p: common_assets._imports_3,\n        q: common_vendor.s(ordersAnimation.value),\n        r: common_vendor.o(navigateToOrders)\n      });\n    };\n  }\n};\nwx.createPage(_sfc_main);\n//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/mall/mall.js.map\n"],"mappings":"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"}