{"version":3,"names":["_objectSpread2","require","common_vendor","common_assets","_sfc_main","__name","setup","__props","item","ref","mediaList","isFavorite","isOwner","openid","formatTime","time","date","Date","offset","setHours","getHours","toISOString","replace","substring","getMediaItemStyle","length","index","onReceive","data","raw","update_time","value","fileList","seller_id","__f__","onMounted","userInfo","getStorageSync","$on","onUnmounted","$off","previewFile","url","previewImage","current","urls","success","fail","err","toggleFavorite","showToast","title","icon","editProduct","navigateTo","res","setTimeout","$emit","buyProduct","goToChat","concat","trade_id","_ctx","_cache","e","a","sellerAvatar","b","t","sellerName","c","d","price","category","f","g","description","h","media","i0","type","o","$event","s","i","j","k","l","m","_imports_0$2","n","p","wx","createPage"],"sources":["pages/mall/detail/detail.js"],"sourcesContent":["\"use strict\";\nconst common_vendor = require(\"../../../common/vendor.js\");\nconst common_assets = require(\"../../../common/assets.js\");\nconst _sfc_main = {\n  __name: \"detail\",\n  setup(__props) {\n    const item = common_vendor.ref({});\n    const mediaList = common_vendor.ref([]);\n    const isFavorite = common_vendor.ref(false);\n    const isOwner = common_vendor.ref(false);\n    const openid = common_vendor.ref(\"\");\n    const formatTime = (time) => {\n      const date = new Date(time);\n      const offset = 8;\n      date.setHours(date.getHours() + offset);\n      return date.toISOString().replace(\"T\", \" \").substring(0, 16);\n    };\n    const getMediaItemStyle = (length, index) => {\n      if (length === 1)\n        return \"width: 98%; height: auto;\";\n      if (length === 2)\n        return \"width: 48%;\";\n      if (length === 3)\n        return index === 0 ? \"width: 98%;\" : \"width: 48%;\";\n      if (length === 4)\n        return \"width: 48%;\";\n      if (length === 5)\n        return index === 0 ? \"width: 98%;\" : \"width: 48%;\";\n      if (length === 6) {\n        if (index === 0)\n          return \"width: 98%;\";\n        if (index === 1 || index === 2)\n          return \"width: 48%;\";\n        return \"width: 32%;\";\n      }\n      return \"\";\n    };\n    function onReceive(data) {\n      const raw = data && data.item ? data.item : data;\n      raw.update_time = formatTime(raw.update_time);\n      mediaList.value = raw.fileList || [];\n      isOwner.value = raw.seller_id === openid.value;\n      item.value = {\n        ...raw\n      };\n      common_vendor.index.__f__(\"log\", \"at pages/mall/detail/detail.vue:97\", \"detail onReceive â†’\", item.value);\n    }\n    common_vendor.onMounted(() => {\n      const userInfo = common_vendor.index.getStorageSync(\"userInfo\");\n      if (userInfo && userInfo.openid) {\n        openid.value = userInfo.openid;\n      }\n      common_vendor.index.$on(\"sendProductData\", onReceive);\n      common_vendor.index.$on(\"product-updated\", onReceive);\n    });\n    onUnmounted(() => {\n      common_vendor.index.$off(\"sendProductData\", onReceive);\n      common_vendor.index.$off(\"product-updated\", onReceive);\n    });\n    const previewFile = (url) => {\n      common_vendor.index.__f__(\"log\", \"at pages/mall/detail/detail.vue:118\", \"ðŸ“· é¢„è§ˆå›¾ç‰‡:\", url);\n      common_vendor.index.previewImage({\n        current: url,\n        urls: [url],\n        success: () => common_vendor.index.__f__(\"log\", \"at pages/mall/detail/detail.vue:122\", \"âœ… å›¾ç‰‡é¢„è§ˆæˆåŠŸ\"),\n        fail: (err) => common_vendor.index.__f__(\"error\", \"at pages/mall/detail/detail.vue:123\", \"âŒ å›¾ç‰‡é¢„è§ˆå¤±è´¥:\", err)\n      });\n    };\n    const toggleFavorite = () => {\n      isFavorite.value = !isFavorite.value;\n      common_vendor.index.showToast({\n        title: isFavorite.value ? \"å·²æ”¶è—\" : \"å–æ¶ˆæ”¶è—\",\n        icon: \"success\"\n      });\n    };\n    const editProduct = () => {\n      common_vendor.index.__f__(\"log\", \"at pages/mall/detail/detail.vue:138\", 111);\n      common_vendor.index.navigateTo({\n        url: \"/pages/mall/post/post\",\n        success: function(res) {\n          setTimeout(() => {\n            common_vendor.index.$emit(\"sendProductData\", {\n              item: item.value\n            });\n          }, 100);\n        }\n      });\n    };\n    const buyProduct = () => {\n      common_vendor.index.__f__(\"log\", \"at pages/mall/detail/detail.vue:154\", 222);\n      common_vendor.index.navigateTo({\n        url: \"/pages/mall/buy/buy\",\n        success: (res) => {\n          setTimeout(() => {\n            common_vendor.index.$emit(\"sendProductData\", {\n              item: item.value\n            });\n          }, 100);\n        }\n      });\n    };\n    const goToChat = () => {\n      common_vendor.index.navigateTo({\n        url: `/pages/mall/chat/chat?trade_id=${item.value.trade_id}&buyer_id=${openid.value}&seller_id=${item.value.seller_id}`\n      });\n    };\n    return (_ctx, _cache) => {\n      return common_vendor.e({\n        a: item.value.sellerAvatar,\n        b: common_vendor.t(item.value.sellerName),\n        c: common_vendor.t(item.value.update_time),\n        d: common_vendor.t(item.value.price),\n        e: common_vendor.t(item.value.category),\n        f: common_vendor.t(item.value.title),\n        g: common_vendor.t(item.value.description || \"æš‚æ— æè¿°\"),\n        h: common_vendor.f(mediaList.value, (media, index, i0) => {\n          return common_vendor.e({\n            a: media.type === \"image\"\n          }, media.type === \"image\" ? {\n            b: common_vendor.o(($event) => previewFile(media.url), index),\n            c: media.url\n          } : media.type === \"video\" ? {\n            e: media.url\n          } : {}, {\n            d: media.type === \"video\",\n            f: index,\n            g: common_vendor.s(getMediaItemStyle(mediaList.value.length, index))\n          });\n        }),\n        i: isFavorite.value ? \"/static/image/collect-active.png\" : \"/static/image/collect.png\",\n        j: common_vendor.t(isFavorite.value ? \"å·²æ”¶è—\" : \"æ”¶è—\"),\n        k: common_vendor.o(toggleFavorite),\n        l: !isOwner.value\n      }, !isOwner.value ? {\n        m: common_assets._imports_0$2,\n        n: common_vendor.o(goToChat)\n      } : {}, {\n        o: common_vendor.t(isOwner.value ? \"ç¼–è¾‘æˆ‘çš„å•†å“\" : \"ç«‹å³è´­ä¹°\"),\n        p: common_vendor.o(($event) => isOwner.value ? editProduct() : buyProduct())\n      });\n    };\n  }\n};\nwx.createPage(_sfc_main);\n//# sourceMappingURL=../../../../.sourcemap/mp-weixin/pages/mall/detail/detail.js.map\n"],"mappings":"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"}